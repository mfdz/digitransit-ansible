#! /bin/bash -e

DOCKER_IMAGE=stadtnavi/delay-prediction-service:{{ delay_prediction_service_version }}

docker pull ${DOCKER_IMAGE}
docker run --rm -i \
    --network delay \
    -v delay-prediction-service-data:/app/data \
    -e TIMEZONE=Europe/Berlin \
    -e LOCALE=de-DE \
    -e GTFS_NAME=vvs \
    -e PGHOST="delay-postgis" \
    -e PGUSER="{{ delay_postgres_user }}" \
    -e PGPASSWORD="{{ delay_postgres_password }}" \
    -e PGDATABASE="{{ delay_postgres_db }}" \
    -e LOG_LEVEL=debug \
    --name delay-prediction-service-cleanup \
    ${DOCKER_IMAGE} \
    ./scripts/cleanup.js
